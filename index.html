<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LxghtBlvee</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>

    <header class="nav">
      <div class="nav-inner">
        <a class="brand" href="#top">LxghtBlvee</a>

        <nav class="nav-links">
          <a href="#about">About</a>
          <a href="#projects">Projects</a>
          <a href="#contact">Contact</a>
          <a href="#music">Music</a>
        </nav>
      </div>
    </header>


    <main class="hero" id="top">
      <div class="bg" id="bg"></div>
      <div class="overlay"></div>

      <div class="content">
        <h1>
          Hiya, I'm
          <span class="accent" id="type-target"></span><span class="cursor">|</span>
        </h1>

        <div class="icons">

          <a
            class="icon-btn"
            href="https://www.roblox.com/users/9519944913/profile"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Roblox"
          >
            <img src="assets/roblox.svg" alt="Roblox" class="icon-img" />
          </a>


          <a
            class="icon-btn"
            href="https://github.com/LxghtBlvee"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="GitHub"
          >
            <img src="assets/github.svg" alt="GitHub" class="icon-img" />
          </a>
        </div>
      </div>
    </main>


    <section class="section" id="about">
      <div class="wrap">
        <h2>About Me</h2>
        <p>
          ðŸ‘‹ Iâ€™m LxghtBlvee - a developer focused on Discord automation, moderation tooling,
          and systems that connect communities with Roblox experiences. You can find me playing some of my favorite games or working on a project of mine.
        </p>
      </div>
    </section>

->
    <section class="section" id="projects">
      <div class="wrap">
        <h2>Projects</h2>

        <div class="cards">
          <article class="card">
            <h3>Helix Bot Contributions</h3>
            <p>General Commands + interaction flow improvements.</p>
          </article>

          <article class="card">
            <h3>Echelon Bot Contributions</h3>
            <p>Developed a backend Node.js service client</p>
          </article>

          <article class="card">
            <h3>TBD</h3>
            <p>TBD.</p>
          </article>
        </div>
      </div>
    </section>

    <section class="section" id="music">
      <div class="wrap">
        <h2>Now Listening</h2>

        <div class="now-card" id="now-card">
          <div class="now-art" id="now-art"></div>

          <div class="now-meta">
            <div class="now-badge" id="now-badge" hidden>
              <span class="dot"></span> Listening now
            </div>

            <div class="now-title" id="now-title">Loadingâ€¦</div>
            <div class="now-artist" id="now-artist"></div>
          </div>

          <a
            class="now-link"
            id="now-link"
            href="#"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Open on Last.fm"
          >
            â†—
          </a>
        </div>
      </div>
    </section>

    <section class="section" id="contact">
      <div class="wrap">
        <h2>Contact</h2>
        <p>
          Find me on
          <a href="https://github.com/LxghtBlvee" target="_blank" rel="noopener noreferrer">GitHub</a>
          and
          <a href="https://www.roblox.com/users/9519944913/profile" target="_blank" rel="noopener noreferrer">Roblox</a>.
        </p>
      </div>
    </section>

    <script>

      const target = document.getElementById("type-target");
      const names = ["LxghtBlvee", "Intel_RookieAlt", "Damian"];
      let nameIndex = 0;

      const typeSpeed = 150;
      const deleteSpeed = 95;
      const holdTime = 4000;
      const pauseBetween = 600;

      function typeText(text, i = 0) {
        if (i <= text.length) {
          target.textContent = text.slice(0, i);
          setTimeout(() => typeText(text, i + 1), typeSpeed);
        } else {
          setTimeout(() => deleteText(text, text.length), holdTime);
        }
      }

      function deleteText(text, i) {
        if (i >= 0) {
          target.textContent = text.slice(0, i);
          setTimeout(() => deleteText(text, i - 1), deleteSpeed);
        } else {
          nameIndex = (nameIndex + 1) % names.length;
          setTimeout(() => typeText(names[nameIndex], 0), pauseBetween);
        }
      }

      typeText(names[nameIndex], 0);

      const NOW_PLAYING_URL =
        "https://lxghtblvee-now-playinga.dickeydamian.workers.dev/";

      let lastSignature = ""; 

      async function updateNowPlaying(force = false) {
        try {
          const res = await fetch(NOW_PLAYING_URL, { cache: "no-store" });
          const song = await res.json();

          const signature = `${song?.nowPlaying}|${song?.title}|${song?.artist}|${song?.albumArt}|${song?.url}`;
          if (!force && signature === lastSignature) return;
          lastSignature = signature;

          const art = document.getElementById("now-art");
          const title = document.getElementById("now-title");
          const artist = document.getElementById("now-artist");
          const link = document.getElementById("now-link");
          const badge = document.getElementById("now-badge");

          const isNow = song?.nowPlaying === true || song?.nowPlaying === "true";

          // badge toggle
          badge.hidden = !isNow;

          // title text
         const baseTitle = song?.title || "Nothing playing";
title.textContent = isNow ? baseTitle : `Last played: ${baseTitle}`;


          artist.textContent = song?.artist || "";
          link.href = song?.url || "https://www.last.fm/user/LxghtBlvee";

          if (song?.albumArt) {
            art.style.backgroundImage = `url("${song.albumArt}")`;
          } else {
            art.style.backgroundImage = "none";
          }
        } catch (e) {
          // fail quietly
        }
      }

      updateNowPlaying(true);

      setInterval(updateNowPlaying, 5000); 
      document.addEventListener("visibilitychange", () => {
        if (!document.hidden) updateNowPlaying(true);
      });

      const bg = document.getElementById("bg");
      const slides = [
        "assets/mountains.jpg",
        "assets/mountains2.jpg",
        "assets/mountains3.jpg",
        "assets/mountains4.jpg",
      ];

      let slideIndex = 0;
      const slideEveryMs = 5000;

      bg.style.backgroundImage = `url("${slides[slideIndex]}")`;

      function nextSlide() {
        bg.style.opacity = "0";
        setTimeout(() => {
          slideIndex = (slideIndex + 1) % slides.length;
          bg.style.backgroundImage = `url("${slides[slideIndex]}")`;
          bg.style.opacity = "1";
        }, 900);
      }

      setInterval(nextSlide, slideEveryMs);
    </script>
  </body>
</html>
