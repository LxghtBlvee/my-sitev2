<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LxghtBlvee</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <!-- Fixed theme toggle (corner) -->
    <button class="theme-fab" id="theme-btn" aria-label="Toggle theme">ðŸŒ™</button>

    <!-- NAV -->
    <header class="nav">
      <div class="nav-inner">
        <a class="brand" href="#top">LxghtBlvee</a>

        <nav class="nav-links">
          <a href="#about">About</a>
          <a href="#projects">Projects</a>
          <a href="#music">Music</a>
          <a href="#contact">Contact</a>
        </nav>
      </div>
    </header>

    <!-- HERO -->
    <main class="hero" id="top">
      <div class="bg" id="bg"></div>
      <div class="overlay"></div>

      <div class="content">
        <h1>
          Hiya, I'm
          <span class="accent" id="type-target"></span><span class="cursor">|</span>
        </h1>

        <div class="icons">
          <a
            class="icon-btn"
            href="https://www.roblox.com/users/9519944913/profile"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Roblox"
          >
            <img src="assets/roblox.svg" alt="Roblox" class="icon-img" />
          </a>

          <a
            class="icon-btn"
            href="https://github.com/LxghtBlvee"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="GitHub"
          >
            <img src="assets/github.svg" alt="GitHub" class="icon-img" />
          </a>
        </div>
      </div>
    </main>

    <!-- ABOUT -->
    <section class="section" id="about">
      <div class="wrap">
        <h2>About Me</h2>
        <p>
          ðŸ‘‹ Iâ€™m LxghtBlvee - a developer focused on Discord automation, moderation tooling,
          and systems that connect communities with Roblox experiences. You can find me playing some of my favorite games
          or working on a project of mine.
        </p>

        <!-- pills belong INSIDE the wrap -->
        <div class="pills">
          <span class="pill">TypeScript</span>
          <span class="pill">Node.js</span>
          <span class="pill">NestJS</span>
          <span class="pill">Discord.js</span>
          <span class="pill">MongoDB</span>
          <span class="pill">Roblox APIs</span>
        </div>
      </div>
    </section>

    <!-- PROJECTS -->
    <section class="section" id="projects">
      <div class="wrap">
        <h2>Projects</h2>

        <div class="cards">
          <article class="card">
            <div class="card-top">
              <h3>Helix Bot Contributions</h3>
              <div class="tags">
                <span class="tag">NestJS</span><span class="tag">Discord.js</span><span class="tag">MongoDB</span>
              </div>
            </div>
            <p>Infraction history improvements, safer typing, cleaner interaction flow.</p>
            <div class="card-actions">
              <a class="btn" href="https://github.com/LxghtBlvee" target="_blank" rel="noopener noreferrer">View GitHub</a>
            </div>
          </article>

          <article class="card">
            <div class="card-top">
              <h3>Echelon Bot Contributions</h3>
              <div class="tags">
                <span class="tag">Node.js</span><span class="tag">APIs</span>
              </div>
            </div>
            <p>Backend service client work + improvements to automation tooling.</p>
            <div class="card-actions">
              <a class="btn" href="https://github.com/LxghtBlvee" target="_blank" rel="noopener noreferrer">View GitHub</a>
            </div>
          </article>

          <article class="card">
            <div class="card-top">
              <h3>Portfolio Site</h3>
              <div class="tags">
                <span class="tag">HTML</span><span class="tag">CSS</span><span class="tag">Cloudflare</span>
              </div>
            </div>
            <p>Hero slideshow, typewriter name, Now Listening powered by Last.fm.</p>
            <div class="card-actions">
              <a class="btn" href="#top">Back to top</a>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- MUSIC -->
    <section class="section" id="music">
      <div class="wrap">
        <h2>Now Listening</h2>

        <div class="now-card" id="now-card">
          <div class="now-art" id="now-art"></div>

          <div class="now-meta">
            <div class="now-badge" id="now-badge" hidden>
              <span class="dot"></span> Listening now
            </div>

            <div class="now-title" id="now-title">Loadingâ€¦</div>
            <div class="now-artist" id="now-artist"></div>
          </div>

          <a
            class="now-link"
            id="now-link"
            href="#"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Open on Last.fm"
          >
            â†—
          </a>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section class="section" id="contact">
      <div class="wrap">
        <h2>Contact</h2>
        <p>
          Find me on
          <a href="https://github.com/LxghtBlvee" target="_blank" rel="noopener noreferrer">GitHub</a>
          and
          <a href="https://www.roblox.com/users/9519944913/profile" target="_blank" rel="noopener noreferrer">Roblox</a>.
        </p>
      </div>
    </section>

    <script>
      // --- Typewriter ---
      const target = document.getElementById("type-target");
      const names = ["LxghtBlvee", "Intel_RookieAlt", "Damian"];
      let nameIndex = 0;

      const typeSpeed = 150;
      const deleteSpeed = 95;
      const holdTime = 4000;
      const pauseBetween = 600;

      function typeText(text, i = 0) {
        if (i <= text.length) {
          target.textContent = text.slice(0, i);
          setTimeout(() => typeText(text, i + 1), typeSpeed);
        } else {
          setTimeout(() => deleteText(text, text.length), holdTime);
        }
      }

      function deleteText(text, i) {
        if (i >= 0) {
          target.textContent = text.slice(0, i);
          setTimeout(() => deleteText(text, i - 1), deleteSpeed);
        } else {
          nameIndex = (nameIndex + 1) % names.length;
          setTimeout(() => typeText(names[nameIndex], 0), pauseBetween);
        }
      }

      typeText(names[nameIndex], 0);

      // --- Now Playing ---
      const NOW_PLAYING_URL = "https://lxghtblvee-now-playinga.dickeydamian.workers.dev/";
      let lastSignature = "";

      async function updateNowPlaying(force = false) {
        try {
          const res = await fetch(NOW_PLAYING_URL, { cache: "no-store" });
          const song = await res.json();

          const signature = `${song?.nowPlaying}|${song?.title}|${song?.artist}|${song?.albumArt}|${song?.url}`;
          if (!force && signature === lastSignature) return;
          lastSignature = signature;

          const art = document.getElementById("now-art");
          const title = document.getElementById("now-title");
          const artist = document.getElementById("now-artist");
          const link = document.getElementById("now-link");
          const badge = document.getElementById("now-badge");

          const isNow = song?.nowPlaying === true || song?.nowPlaying === "true";

          badge.hidden = !isNow;

          const baseTitle = song?.title || "Nothing playing";
          title.textContent = isNow ? baseTitle : `Last played: ${baseTitle}`;

          artist.textContent = song?.artist || "";
          link.href = song?.url || "https://www.last.fm/user/LxghtBlvee";

          art.style.backgroundImage = song?.albumArt ? `url("${song.albumArt}")` : "none";
        } catch (e) {}
      }

      updateNowPlaying(true);
      setInterval(updateNowPlaying, 5000);
      document.addEventListener("visibilitychange", () => {
        if (!document.hidden) updateNowPlaying(true);
      });

      // --- Active nav link highlight ---
      const sectionIds = ["about", "projects", "music", "contact"];
      const navLinks = Array.from(document.querySelectorAll(".nav-links a"));

      const setActive = (id) => {
        navLinks.forEach((a) =>
          a.classList.toggle("active", a.getAttribute("href") === `#${id}`)
        );
      };

      const observer = new IntersectionObserver(
        (entries) => {
          const visible = entries
            .filter((e) => e.isIntersecting)
            .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];
          if (visible) setActive(visible.target.id);
        },
        { threshold: [0.25, 0.4, 0.6] }
      );

      sectionIds.forEach((id) => {
        const el = document.getElementById(id);
        if (el) observer.observe(el);
      });

      // --- Theme toggle ---
      const themeBtn = document.getElementById("theme-btn");
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme === "dark") document.body.classList.add("dark");
      themeBtn.textContent = document.body.classList.contains("dark") ? "â˜€ï¸" : "ðŸŒ™";

      themeBtn.addEventListener("click", () => {
        document.body.classList.toggle("dark");
        const isDark = document.body.classList.contains("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
        themeBtn.textContent = isDark ? "â˜€ï¸" : "ðŸŒ™";
      });

      // --- Static Background ---
const bg = document.getElementById("bg");
bg.style.backgroundImage = `url("assets/city.webp")`;


      window.addEventListener("mousemove", (e) => {
        const hero = document.querySelector(".hero");
        if (!hero) return;
        const r = hero.getBoundingClientRect();
        const x = (e.clientX - r.left) / r.width - 0.5;
        const y = (e.clientY - r.top) / r.height - 0.5;
        bg.style.transform = `translate(${x * 8}px, ${y * 8}px) scale(1.02)`;
      });
    </script>
  </body>
</html>
